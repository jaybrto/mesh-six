---
# ExternalSecret: syncs main operational secrets from Vault â†’ K8s Secret "mesh-six-secrets"
# Requires ClusterSecretStore "vault-backend" to already exist in the cluster
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mesh-six-main-secrets
  namespace: mesh-six
  labels:
    app.kubernetes.io/part-of: mesh-six
    component: secrets
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: ClusterSecretStore
  target:
    name: mesh-six-secrets
    creationPolicy: Owner
    deletionPolicy: Retain
  data:
    - secretKey: PG_USER
      remoteRef:
        key: secret/data/mesh-six
        property: pg-user
    - secretKey: PG_PASSWORD
      remoteRef:
        key: secret/data/mesh-six
        property: pg-password
    - secretKey: GITHUB_TOKEN
      remoteRef:
        key: secret/data/mesh-six
        property: github-token
    - secretKey: VAULT_TOKEN
      remoteRef:
        key: secret/data/mesh-six
        property: vault-token
    - secretKey: MINIO_ACCESS_KEY
      remoteRef:
        key: secret/data/mesh-six
        property: minio-access-key
    - secretKey: MINIO_SECRET_KEY
      remoteRef:
        key: secret/data/mesh-six
        property: minio-secret-key
    - secretKey: LITELLM_ADMIN_KEY
      remoteRef:
        key: secret/data/mesh-six
        property: litellm-admin-key
    - secretKey: GIT_USERNAME
      remoteRef:
        key: secret/data/mesh-six
        property: git-username
    - secretKey: GIT_PASSWORD
      remoteRef:
        key: secret/data/mesh-six
        property: git-password
