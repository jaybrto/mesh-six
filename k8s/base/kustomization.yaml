apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: mesh-six

resources:
  - namespace.yaml
  # secrets.yaml excluded: secrets are managed manually via kubectl, not ArgoCD.
  # ArgoCD syncing secrets.yaml overwrites real values with empty placeholders.
  # Create secrets manually â€” see docs/plans/2026-02-18-finish-all-milestones.md Task 6.
  - vault-external-secrets.yaml
  - dapr-components/
  - orchestrator/
  - simple-agent/
  - architect-agent/
  - researcher-agent/
  - project-manager/
  - qa-tester/
  - api-coder/
  - ui-agent/
  - argocd-deployer/
  - kubectl-deployer/
  - claude-mqtt-bridge/
  - context-service/
  - homelab-monitor/
  - infra-manager/
  - cost-tracker/
  - dashboard/
  - event-logger/
  - webhook-receiver/
  - llm-service/

commonLabels:
  app.kubernetes.io/part-of: mesh-six

# Add imagePullSecrets to all Deployments for Gitea registry auth
patches:
  - target:
      kind: Deployment
    patch: |-
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: placeholder
      spec:
        template:
          spec:
            imagePullSecrets:
              - name: gitea-registry-secret
